var PlayerMovement=pc.createScript("playerMovement");PlayerMovement.attributes.add("speed",{type:"number",default:.09}),PlayerMovement.prototype.initialize=function(){var e=this.app.root.findByName("Camera");this.cameraScript=e.script.cameraMovement},PlayerMovement.worldDirection=new pc.Vec3,PlayerMovement.tempDirection=new pc.Vec3,PlayerMovement.prototype.update=function(e){var t=this.app,i=PlayerMovement.worldDirection;i.set(0,0,0);var a=PlayerMovement.tempDirection,r=this.entity.forward,o=this.entity.right,n=0,c=0;if(t.keyboard.isPressed(pc.KEY_A)&&(n-=1),t.keyboard.isPressed(pc.KEY_D)&&(n+=1),t.keyboard.isPressed(pc.KEY_W)&&(c+=1),t.keyboard.isPressed(pc.KEY_S)&&(c-=1),0!==n||0!==c){i.add(a.copy(r).mulScalar(c)),i.add(a.copy(o).mulScalar(n)),i.normalize();var s=new pc.Vec3(i.x*e,0,i.z*e);s.normalize().scale(this.speed),s.add(this.entity.getPosition());var p=this.cameraScript.eulers.x+180,l=new pc.Vec3(0,p,0);this.entity.rigidbody.teleport(s,l)}this.entity.anim.setFloat("xDirection",n),this.entity.anim.setFloat("zDirection",c),console.log(this.entity.anim.getFloat("xDirection"),this.entity.anim.getFloat("zDirection")),console.log(this.entity.anim.baseLayer.activeState)};var CameraMovement=pc.createScript("cameraMovement");CameraMovement.attributes.add("mouseSpeed",{type:"number",default:1.4,description:"Mouse Sensitivity"}),CameraMovement.prototype.initialize=function(){this.eulers=new pc.Vec3,this.touchCoords=new pc.Vec2;var e=this.app;e.mouse.on("mousemove",this.onMouseMove,this),e.mouse.on("mousedown",this.onMouseDown,this),this.rayEnd=e.root.findByName("RaycastEndPoint"),this.on("destroy",(function(){e.mouse.off("mousemove",this.onMouseMove,this),e.mouse.off("mousedown",this.onMouseDown,this)}),this)},CameraMovement.prototype.postUpdate=function(e){var t=this.entity.parent,o=this.eulers.x+180,s=this.eulers.y,i=new pc.Vec3(-s,o,0);t.setEulerAngles(i),this.entity.setPosition(this.getWorldPoint()),this.entity.lookAt(t.getPosition())},CameraMovement.prototype.onMouseMove=function(e){pc.Mouse.isPointerLocked()&&(this.eulers.x-=this.mouseSpeed*e.dx/60%360,this.eulers.y+=this.mouseSpeed*e.dy/60%360,this.eulers.x<0&&(this.eulers.x+=360),this.eulers.y<0&&(this.eulers.y+=360))},CameraMovement.prototype.onMouseDown=function(e){this.app.mouse.enablePointerLock()},CameraMovement.prototype.getWorldPoint=function(){var e=this.entity.parent.getPosition(),t=this.rayEnd.getPosition(),o=this.app.systems.rigidbody.raycastFirst(e,t);return o?o.point:t};